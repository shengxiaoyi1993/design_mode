# 2 实例：设计一个文档编辑器

## 2.1 设计问题 

- 文档结构
- 格式化
- 修饰用户界面
- 支持多视感
- 支持多窗口系统
- 用户操作
- 拼写检查和连字符 

## 2.2 文档结构

- 文档本质上是对字符、线、多边形和其他图形元素的组织
- 对于文档作者来说是行、列、图形、表和其他子结构

- 目标

  - 保持物理结构，即将文本和图形安排到行、列、表

  - 可视化生成和显示文档

  - 根据显示位置决定映射文档与内部表示的元素

- 规则
  
  - 一致对待文本和图形

  - 不能过分强调元素与组合物的区别

  - 然而格式检查与连字符又需要区分组合体和元素

 

### 2.2.1 递归组合

- 由简单的元素逐渐建立复杂的元素
- 将重要元素表示为对象

### 2.2.2 图元

- 抽象类图元：既定义可基本的图形元素，又定义了结构元素
  - 行为
    - 画出自己
    - 占用的空间
    - 记录父图元与子图元 

### 2.2.3 组合模式

-  



## 2.3 格式化 

- 构造一个数据结构，对应于一个恰当格式化了的文档
- 由lexi格式化算法得到



### 2.3.1 封装格式化算法

- 格式化的质量与格式化的速度的矛盾 
- 较优的设计是格式化算法与图元类之间相互独立



### 2.3.2 compositor 和composition 